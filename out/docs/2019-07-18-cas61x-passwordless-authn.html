<hr>
<h2>
<a id="layout-----posttitle------apereo-cas---passwordless-authenticationsummary----learn-how-to-modify-apereo-cas-to-allow-users-to-login-without-the-need-to-remember-a-passwordtags-------cas" class="anchor" href="#layout-----posttitle------apereo-cas---passwordless-authenticationsummary----learn-how-to-modify-apereo-cas-to-allow-users-to-login-without-the-need-to-remember-a-passwordtags-------cas" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>layout:     post<br>
title:      Apereo CAS - Passwordless Authentication<br>
summary:    Learn how to modify Apereo CAS to allow users to login without the need to remember a password.<br>
tags:       [CAS]</h2>
<!-- raw HTML omitted -->
<h1>
<a id="overview" class="anchor" href="#overview" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Overview</h1>
<p><a href="https://apereo.github.io/cas/development/installation/Passwordless-Authentication.html">Passwordless authentication</a> in CAS allows users to login without having to type in a password. Instead, passwords take the form of tokens that expire after a configurable period and are shared with users using communication methods such as email or SMS. Using this strategy, users are simply asked for an identifier (i.e. username) which is used to locate the user record that contains forms of contact such as email and phone number.</p>
<p>This is a short tutorial on how to set up CAS to use Passwordless Authentication to avoid the insecure practice of using a shared password for different services and improve user experience, especially for mobile devices and applications.</p>
<p>Our starting position is based on:</p>
<ul>
<li>CAS <code>6.1.x</code>
</li>
<li>Java <code>11</code>
</li>
<li><a href="https://github.com/apereo/cas-overlay-template">CAS WAR Overlay</a></li>
</ul>
<h1>
<a id="configuration" class="anchor" href="#configuration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuration</h1>
<p>Once you have decorated the CAS WAR Overlay with the proper <a href="https://apereo.github.io/cas/development/installation/Passwordless-Authentication.html">extension module</a>, you will need to adjust your CAS configuration (i.e. <code>cas.properties</code> file) to tune the feature for the following:</p>
<h2>
<a id="user-accounts" class="anchor" href="#user-accounts" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>User Accounts</h2>
<p>How should user records and contact information be found, given an identifier?</p>
<p>To keep things simple for this tutorial, we are going to use a static map of usernames that are linked to their methods of contact, such as email or phone number. The key in the map is taken to be the username eligible for authentication while the value can either be an email address or phone number that would be used to contact the user with issued tokens.</p>
<pre lang="properties"><code>cas.authn.passwordless.accounts.simple.casuser=casuser@somewhere.org
</code></pre>
<h2>
<a id="token-security" class="anchor" href="#token-security" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Token Security</h2>
<p>Tokens generated by CAS and shared with users are signed and encrypted. We can instruct CAS to use specific crypto keys for this purpose.</p>
<pre lang="properties"><code>cas.authn.passwordless.tokens.crypto.encryption.key=bezKhHW...
cas.authn.passwordless.tokens.crypto.signing.key=KNV8PAClVycu...
</code></pre>
<p>If you skip this step, CAS will automatically generate at startup and will issue warnings in the logs for you.</p>
<p>We can also adjust the expiration time of generated tokens:</p>
<pre lang="properties"><code>cas.authn.passwordless.tokens.expireInSeconds=30
</code></pre>
<h2>
<a id="communication-strategy" class="anchor" href="#communication-strategy" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Communication Strategy</h2>
<p>To keep things simple, we will configure CAS to share tokens with users via email. How do we configure email settings such as message body, from, subject and the server settings?</p>
<pre lang="properties"><code>cas.authn.passwordless.tokens.mail.from=cas-server@somewhere.org
cas.authn.passwordless.tokens.mail.text=Your CAS Passwordless token is &lt;strong&gt;%s&lt;/strong&gt;.
cas.authn.passwordless.tokens.mail.subject=Your CAS Passwordless Token
cas.authn.passwordless.tokens.mail.html=true
</code></pre>
<p>We will also instruct CAS (and Spring Boot underneath) to use a dummy email server, running on <code>localhost</code>:</p>
<pre lang="properties"><code>spring.mail.host=localhost
spring.mail.port=25000
# spring.mail.testConnection=true
</code></pre>
<h1>
<a id="thou-shall-test" class="anchor" href="#thou-shall-test" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Thou Shall Test</h1>
<p>Once you attempt to access a CAS-protected application and assuming the application is properly registered with CAS, you'd be redirected to the CAS login screen as such:</p>
<p><img src="https://user-images.githubusercontent.com/1205228/61450175-c1d3f880-a96b-11e9-9c51-0160d1804cf8.png" alt="image"></p>
<p><code>casuser</code> is the only entry in our simple account store that is set up for passwordless authentication. Once <code>casuser</code> logs in, CAS will ask for the shared token that is now shared with the user via an email message:</p>
<p><img src="https://user-images.githubusercontent.com/1205228/61450399-3d35aa00-a96c-11e9-9f3f-497bbb26a2b2.png" alt="image"></p>
<p>The email message from CAS will arrive in the user's inbox with the token:</p>
<p><img src="https://user-images.githubusercontent.com/1205228/61450441-56d6f180-a96c-11e9-8dd0-18fc164f1fe6.png" alt="image"></p>
<p>Assuming the token is still valid, CAS will ask and accept the token from the user and will proceed normally to route the flow to the requested application.</p>
<p>Pretty simple, eh?</p>
<h1>
<a id="so" class="anchor" href="#so" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>So...</h1>
<p>I hope this review was of some help to you and I am sure that both this post as well as the functionality it attempts to explain can be improved in any number of ways. Please know that all other use cases, scenarios, features, and theories certainly <a href="https://apereo.github.io/2017/02/18/onthe-theoryof-possibility/">are possible</a> as well. Feel free to <a href="https://apereo.github.io/cas/developer/Contributor-Guidelines.html">engage and contribute</a> as best as you can.</p>
<p>Happy Coding,</p>
<p><a href="https://fawnoos.com">Misagh Moayyed</a></p>